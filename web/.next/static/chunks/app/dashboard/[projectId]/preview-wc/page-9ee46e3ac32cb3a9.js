(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[572],{5624:function(e,t,r){Promise.resolve().then(r.bind(r,7414))},7414:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var s=r(7437),a=r(2265),l=r(9376),n=r(4667),i=r(1578),c=r(1357),o=r(9116);function d(){let e=(0,l.useParams)().projectId,[t,r]=(0,a.useState)({previewHtml:null,files:[]}),[d,u]=(0,a.useState)([]),[m,x]=(0,a.useState)(!1),[f,b]=(0,a.useState)(null),[g,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{try{var t;let s=sessionStorage.getItem("build:".concat(e));if(!s)return;let a=JSON.parse(s);r({previewHtml:null!==(t=null==a?void 0:a.previewHtml)&&void 0!==t?t:null,files:Array.isArray(null==a?void 0:a.files)?a.files:[]})}catch(e){}},[e]),(0,a.useEffect)(()=>{try{let t=sessionStorage.getItem("messages:".concat(e));if(!t)return;let r=JSON.parse(t);u(Array.isArray(r)?r:[])}catch(e){}},[e]),(0,a.useEffect)(()=>{try{sessionStorage.setItem("messages:".concat(e),JSON.stringify(d))}catch(e){}},[d,e]);let p=(0,a.useMemo)(()=>f?Math.max(0,Math.ceil((f-Date.now())/1e3)):0,[f]);(0,a.useEffect)(()=>{if(!f)return;if(p<=0){b(null),y(null);return}let e=window.setInterval(()=>{b(e=>e)},250);return()=>window.clearInterval(e)},[f,p]);let v=async t=>{let r=[...d,{id:String(Date.now()),role:"user",content:t,timestamp:new Date().toISOString()}];u(r),x(!0);try{let t=await (0,o.bG)(e,r,"edit");u([...r,t]),y(null)}catch(e){if(e instanceof o.MS&&429===e.status){var s;let t=null!==(s=e.retryAfterSeconds)&&void 0!==s?s:60;b(Date.now()+1e3*t),y("Rate limit reached. Try again in ".concat(t,"s."))}else y(e instanceof o.MS?e.bodyText||e.message:e instanceof Error?e.message:"Failed to send")}finally{x(!1)}};return(0,a.useMemo)(()=>!!t.previewHtml,[t.previewHtml]),(0,s.jsxs)("div",{className:"h-screen w-full bg-black text-gray-100 flex overflow-hidden",children:[(0,s.jsxs)("div",{className:"w-[420px] min-w-[420px] max-w-[520px] border-r border-gray-800 bg-[#0b0b0c] flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-800",children:[(0,s.jsx)("div",{className:"text-xs text-gray-400",children:"Start application"}),(0,s.jsx)("div",{className:"mt-2 rounded-lg border border-gray-800 bg-black px-3 py-2 font-mono text-xs text-gray-200",children:"npm run dev"}),(0,s.jsxs)("div",{className:"mt-3 text-xs text-gray-500 truncate",children:["Project: ",e]}),(0,s.jsx)("div",{className:"mt-3 text-[11px] text-gray-500",children:"WebContainer preview mode. Requires NEXT_PUBLIC_WEBCONTAINER_CLIENT_ID."})]}),(0,s.jsxs)("div",{className:"flex-1 min-h-0",children:[g?(0,s.jsx)("div",{className:"p-3 border-b border-gray-800 bg-black",children:(0,s.jsx)("div",{className:"rounded-lg border border-gray-800 bg-gray-950 px-3 py-2 text-xs text-gray-200",children:p>0?"Rate limited. Retry in ".concat(p,"s."):g})}):null,(0,s.jsx)(n.Z,{messages:d,isLoading:m})]}),(0,s.jsx)("div",{className:"border-t border-gray-800 bg-[#0b0b0c] p-3",children:(0,s.jsx)(i.Z,{onSend:v,isLoading:m||p>0,placeholder:p>0?"Rate limited. Try again in ".concat(p,"s..."):"How can Bolt help you today? (or /command)"})})]}),(0,s.jsx)("div",{className:"flex-1 min-w-0 bg-black",children:(0,s.jsx)(c.Z,{projectId:e,files:t.files,previewHtml:t.previewHtml,forceWebContainer:!0,title:"Workbench (WebContainer)"})})]})}}},function(e){e.O(0,[310,114,276,971,117,744],function(){return e(e.s=5624)}),_N_E=e.O()}]);