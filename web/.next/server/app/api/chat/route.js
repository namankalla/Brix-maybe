"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=E%3A%5CAI%20App%20Builder%5CFGH%5CBrix-maybe%5Cweb%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CAI%20App%20Builder%5CFGH%5CBrix-maybe%5Cweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=E%3A%5CAI%20App%20Builder%5CFGH%5CBrix-maybe%5Cweb%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CAI%20App%20Builder%5CFGH%5CBrix-maybe%5Cweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var E_AI_App_Builder_FGH_Brix_maybe_web_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"E:\\\\AI App Builder\\\\FGH\\\\Brix-maybe\\\\web\\\\app\\\\api\\\\chat\\\\route.ts\",\n    nextConfigOutput,\n    userland: E_AI_App_Builder_FGH_Brix_maybe_web_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj1FJTNBJTVDQUklMjBBcHAlMjBCdWlsZGVyJTVDRkdIJTVDQnJpeC1tYXliZSU1Q3dlYiU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RSUzQSU1Q0FJJTIwQXBwJTIwQnVpbGRlciU1Q0ZHSCU1Q0JyaXgtbWF5YmUlNUN3ZWImaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2tCO0FBQy9GO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWktYXBwLWJ1aWxkZXItd2ViLz8xYjIxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkU6XFxcXEFJIEFwcCBCdWlsZGVyXFxcXEZHSFxcXFxCcml4LW1heWJlXFxcXHdlYlxcXFxhcHBcXFxcYXBpXFxcXGNoYXRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoYXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jaGF0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRTpcXFxcQUkgQXBwIEJ1aWxkZXJcXFxcRkdIXFxcXEJyaXgtbWF5YmVcXFxcd2ViXFxcXGFwcFxcXFxhcGlcXFxcY2hhdFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2hhdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=E%3A%5CAI%20App%20Builder%5CFGH%5CBrix-maybe%5Cweb%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CAI%20App%20Builder%5CFGH%5CBrix-maybe%5Cweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _app_services_gemini__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/app/services/gemini */ \"(rsc)/./app/services/gemini.ts\");\n\n\nasync function POST(request) {\n    try {\n        console.log(\"Chat API called\");\n        const { projectId, messages, mode, uiContext } = await request.json();\n        const safeMode = mode === \"build\" ? \"build\" : mode === \"edit\" ? \"edit\" : \"interview\";\n        const lastUserMessage = Array.isArray(messages) ? [\n            ...messages\n        ].reverse().find((m)=>m?.role === \"user\") : undefined;\n        const userText = lastUserMessage?.content || \"\";\n        const systemPrompt = `<identity>\r\nYou are an AI App Builder.\r\n\r\nYour purpose is to help non-technical users design, refine, and build complete applications\r\nthrough natural conversation.\r\n\r\nYou are NOT a generic chatbot.\r\nYou behave like a thoughtful product manager + senior engineer combined.\r\n</identity>\r\n\r\n<core_mission>\r\nYour job is to:\r\n1) Interview users to deeply understand their app idea\r\n2) Convert vague ideas into clear product requirements\r\n3) Help refine UI/UX decisions\r\n4) Prepare clean, structured build plans\r\n5) Assist with edits after the app is generated\r\n\r\nYou do NOT rush to code.\r\nYou build understanding first.\r\n</core_mission>\r\n\r\n<modes>\r\nYou operate in THREE modes only:\r\n\r\n1) INTERVIEW MODE\r\n2) BUILD MODE\r\n3) EDIT MODE\r\n</modes>\r\n\r\n--------------------------------------------------\r\nINTERVIEW MODE\r\n--------------------------------------------------\r\n\r\n<interview_role>\r\nIn interview mode, you act like a patient and curious product manager.\r\n\r\nThe user is assumed to be NON-TECHNICAL.\r\nThey may not know correct terms.\r\nThey may be confused.\r\nThat is expected.\r\n\r\nYour job is to guide them.\r\n</interview_role>\r\n\r\n<interview_rules>\r\n1) Ask ONLY ONE clear question at a time\r\n2) Use simple, human language\r\n3) Never overwhelm the user\r\n4) Never generate code\r\n5) Be curious and ask follow-ups\r\n6) Keep responses short and friendly\r\n7) If something is missing, ask for it\r\n</interview_rules>\r\n\r\n<interview_coverage>\r\nOver the course of the conversation, you MUST uncover:\r\n\r\n- App type and main goal\r\n- Problem it solves\r\n- Target users\r\n- Primary user flows\r\n- Key screens or pages\r\n- Data entities and fields\r\n- Actions (create, edit, delete, search)\r\n- Authentication (yes or no, methods)\r\n- Roles and permissions (admin, user, etc.)\r\n- Integrations (payments, email, SMS, maps, AI, etc.)\r\n- Design style (colors, vibe, inspiration)\r\n- Platforms (web, mobile, both)\r\n- Constraints (deadline, budget, complexity)\r\n</interview_coverage>\r\n\r\n<interview_boundary>\r\nIf the user asks for code or says \"build\":\r\nPolitely explain that the app will be built only when they click Build.\r\nThen continue the interview.\r\n</interview_boundary>\r\n\r\nReturn plain text only.`;\n        const conversationText = Array.isArray(messages) ? messages.slice(-20).map((m)=>`${m.role?.toUpperCase?.() || \"USER\"}: ${m.content || \"\"}`).join(\"\\n\") : \"\";\n        const editSystemPrompt = `<edit_role>\r\nIn edit mode, you help refine or improve an already-generated app.\r\n\r\nYou behave like a UI/UX-focused product engineer.\r\n</edit_role>\r\n\r\n<edit_rules>\r\n1) Be direct and actionable\r\n2) Prefer proposing a concrete change\r\n3) Ask a clarifying question ONLY if required\r\n4) Use provided UI context from clicked elements\r\n5) Avoid huge explanations\r\n</edit_rules>\r\n\r\n<edit_output>\r\nYour response should include:\r\n- A short plan OR\r\n- A specific UI/UX suggestion OR\r\n- A focused improvement proposal\r\n</edit_output>\r\n\r\nReturn plain text only.`;\n        const contextText = uiContext ? `\\n\\nUI CONTEXT (from clicked element):\\n- selector: ${uiContext.selector || \"\"}\\n- text: ${uiContext.text || \"\"}\\n- htmlSnippet: ${uiContext.htmlSnippet || \"\"}\\n- url: ${uiContext.url || \"\"}\\n` : \"\";\n        const prompt = safeMode === \"build\" ? `The user clicked Build. Summarize the final requirements in 10-20 bullet points.\\n\\nConversation:\\n${conversationText}` : safeMode === \"edit\" ? `${editSystemPrompt}\\n\\nConversation so far:\\n${conversationText}${contextText}\\n\\nUser request: ${userText}\\n\\nRespond with the best next step / change proposal.` : `${systemPrompt}\\n\\nConversation so far:\\n${conversationText}\\n\\nLast user message: ${userText}\\n\\nNow respond with your next single question.`;\n        const response = await (0,_app_services_gemini__WEBPACK_IMPORTED_MODULE_1__.generateText)(prompt);\n        console.log(\"Generated response:\", response);\n        const reply = {\n            id: String(Date.now() + 1),\n            role: \"assistant\",\n            content: response,\n            timestamp: new Date().toISOString()\n        };\n        console.log(\"Sending reply:\", reply);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(reply);\n    } catch (error) {\n        console.error(\"Error in chat API:\", error);\n        const msg = error instanceof Error ? error.message : String(error ?? \"Unknown error\");\n        const m = msg.match(/retryDelay\"\\s*:\\s*\"(\\d+)s\"/i);\n        const retryAfterSeconds = m ? Number(m[1]) : undefined;\n        const isRateLimited = msg.includes(\"Gemini API Error: 429\") || msg.includes(\"RESOURCE_EXHAUSTED\");\n        if (isRateLimited) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"RATE_LIMITED\",\n                details: msg,\n                retryAfterSeconds: retryAfterSeconds ?? 60\n            }, {\n                status: 429,\n                headers: {\n                    \"Retry-After\": String(retryAfterSeconds ?? 60)\n                }\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to generate response\",\n            details: msg\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjtZQUFHLEdBQ2xGO2dCQUNFSyxRQUFRO2dCQUNSQyxTQUFTO29CQUFFLGVBQWVoQixPQUFPVSxxQkFBcUI7Z0JBQUk7WUFDNUQ7UUFFSjtRQUNBLE9BQU9oRCxxREFBWUEsQ0FBQ1UsSUFBSSxDQUN0QjtZQUFFaUMsT0FBTztZQUErQlMsU0FBU1I7UUFBSSxHQUNyRDtZQUFFUyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWFwcC1idWlsZGVyLXdlYi8uL2FwcC9hcGkvY2hhdC9yb3V0ZS50cz9kZTQ2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgZ2VuZXJhdGVUZXh0IH0gZnJvbSAnQC9hcHAvc2VydmljZXMvZ2VtaW5pJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coJ0NoYXQgQVBJIGNhbGxlZCcpO1xyXG4gICAgXHJcbiAgICBjb25zdCB7IHByb2plY3RJZCwgbWVzc2FnZXMsIG1vZGUsIHVpQ29udGV4dCB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcbiAgICBjb25zdCBzYWZlTW9kZTogJ2ludGVydmlldycgfCAnYnVpbGQnIHwgJ2VkaXQnID0gbW9kZSA9PT0gJ2J1aWxkJyA/ICdidWlsZCcgOiBtb2RlID09PSAnZWRpdCcgPyAnZWRpdCcgOiAnaW50ZXJ2aWV3JztcclxuICAgIGNvbnN0IGxhc3RVc2VyTWVzc2FnZSA9IEFycmF5LmlzQXJyYXkobWVzc2FnZXMpXHJcbiAgICAgID8gWy4uLm1lc3NhZ2VzXS5yZXZlcnNlKCkuZmluZCgobTogYW55KSA9PiBtPy5yb2xlID09PSAndXNlcicpXHJcbiAgICAgIDogdW5kZWZpbmVkO1xyXG4gICAgY29uc3QgdXNlclRleHQgPSBsYXN0VXNlck1lc3NhZ2U/LmNvbnRlbnQgfHwgJyc7XHJcblxyXG4gICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYDxpZGVudGl0eT5cclxuWW91IGFyZSBhbiBBSSBBcHAgQnVpbGRlci5cclxuXHJcbllvdXIgcHVycG9zZSBpcyB0byBoZWxwIG5vbi10ZWNobmljYWwgdXNlcnMgZGVzaWduLCByZWZpbmUsIGFuZCBidWlsZCBjb21wbGV0ZSBhcHBsaWNhdGlvbnNcclxudGhyb3VnaCBuYXR1cmFsIGNvbnZlcnNhdGlvbi5cclxuXHJcbllvdSBhcmUgTk9UIGEgZ2VuZXJpYyBjaGF0Ym90LlxyXG5Zb3UgYmVoYXZlIGxpa2UgYSB0aG91Z2h0ZnVsIHByb2R1Y3QgbWFuYWdlciArIHNlbmlvciBlbmdpbmVlciBjb21iaW5lZC5cclxuPC9pZGVudGl0eT5cclxuXHJcbjxjb3JlX21pc3Npb24+XHJcbllvdXIgam9iIGlzIHRvOlxyXG4xKSBJbnRlcnZpZXcgdXNlcnMgdG8gZGVlcGx5IHVuZGVyc3RhbmQgdGhlaXIgYXBwIGlkZWFcclxuMikgQ29udmVydCB2YWd1ZSBpZGVhcyBpbnRvIGNsZWFyIHByb2R1Y3QgcmVxdWlyZW1lbnRzXHJcbjMpIEhlbHAgcmVmaW5lIFVJL1VYIGRlY2lzaW9uc1xyXG40KSBQcmVwYXJlIGNsZWFuLCBzdHJ1Y3R1cmVkIGJ1aWxkIHBsYW5zXHJcbjUpIEFzc2lzdCB3aXRoIGVkaXRzIGFmdGVyIHRoZSBhcHAgaXMgZ2VuZXJhdGVkXHJcblxyXG5Zb3UgZG8gTk9UIHJ1c2ggdG8gY29kZS5cclxuWW91IGJ1aWxkIHVuZGVyc3RhbmRpbmcgZmlyc3QuXHJcbjwvY29yZV9taXNzaW9uPlxyXG5cclxuPG1vZGVzPlxyXG5Zb3Ugb3BlcmF0ZSBpbiBUSFJFRSBtb2RlcyBvbmx5OlxyXG5cclxuMSkgSU5URVJWSUVXIE1PREVcclxuMikgQlVJTEQgTU9ERVxyXG4zKSBFRElUIE1PREVcclxuPC9tb2Rlcz5cclxuXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbklOVEVSVklFVyBNT0RFXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG48aW50ZXJ2aWV3X3JvbGU+XHJcbkluIGludGVydmlldyBtb2RlLCB5b3UgYWN0IGxpa2UgYSBwYXRpZW50IGFuZCBjdXJpb3VzIHByb2R1Y3QgbWFuYWdlci5cclxuXHJcblRoZSB1c2VyIGlzIGFzc3VtZWQgdG8gYmUgTk9OLVRFQ0hOSUNBTC5cclxuVGhleSBtYXkgbm90IGtub3cgY29ycmVjdCB0ZXJtcy5cclxuVGhleSBtYXkgYmUgY29uZnVzZWQuXHJcblRoYXQgaXMgZXhwZWN0ZWQuXHJcblxyXG5Zb3VyIGpvYiBpcyB0byBndWlkZSB0aGVtLlxyXG48L2ludGVydmlld19yb2xlPlxyXG5cclxuPGludGVydmlld19ydWxlcz5cclxuMSkgQXNrIE9OTFkgT05FIGNsZWFyIHF1ZXN0aW9uIGF0IGEgdGltZVxyXG4yKSBVc2Ugc2ltcGxlLCBodW1hbiBsYW5ndWFnZVxyXG4zKSBOZXZlciBvdmVyd2hlbG0gdGhlIHVzZXJcclxuNCkgTmV2ZXIgZ2VuZXJhdGUgY29kZVxyXG41KSBCZSBjdXJpb3VzIGFuZCBhc2sgZm9sbG93LXVwc1xyXG42KSBLZWVwIHJlc3BvbnNlcyBzaG9ydCBhbmQgZnJpZW5kbHlcclxuNykgSWYgc29tZXRoaW5nIGlzIG1pc3NpbmcsIGFzayBmb3IgaXRcclxuPC9pbnRlcnZpZXdfcnVsZXM+XHJcblxyXG48aW50ZXJ2aWV3X2NvdmVyYWdlPlxyXG5PdmVyIHRoZSBjb3Vyc2Ugb2YgdGhlIGNvbnZlcnNhdGlvbiwgeW91IE1VU1QgdW5jb3ZlcjpcclxuXHJcbi0gQXBwIHR5cGUgYW5kIG1haW4gZ29hbFxyXG4tIFByb2JsZW0gaXQgc29sdmVzXHJcbi0gVGFyZ2V0IHVzZXJzXHJcbi0gUHJpbWFyeSB1c2VyIGZsb3dzXHJcbi0gS2V5IHNjcmVlbnMgb3IgcGFnZXNcclxuLSBEYXRhIGVudGl0aWVzIGFuZCBmaWVsZHNcclxuLSBBY3Rpb25zIChjcmVhdGUsIGVkaXQsIGRlbGV0ZSwgc2VhcmNoKVxyXG4tIEF1dGhlbnRpY2F0aW9uICh5ZXMgb3Igbm8sIG1ldGhvZHMpXHJcbi0gUm9sZXMgYW5kIHBlcm1pc3Npb25zIChhZG1pbiwgdXNlciwgZXRjLilcclxuLSBJbnRlZ3JhdGlvbnMgKHBheW1lbnRzLCBlbWFpbCwgU01TLCBtYXBzLCBBSSwgZXRjLilcclxuLSBEZXNpZ24gc3R5bGUgKGNvbG9ycywgdmliZSwgaW5zcGlyYXRpb24pXHJcbi0gUGxhdGZvcm1zICh3ZWIsIG1vYmlsZSwgYm90aClcclxuLSBDb25zdHJhaW50cyAoZGVhZGxpbmUsIGJ1ZGdldCwgY29tcGxleGl0eSlcclxuPC9pbnRlcnZpZXdfY292ZXJhZ2U+XHJcblxyXG48aW50ZXJ2aWV3X2JvdW5kYXJ5PlxyXG5JZiB0aGUgdXNlciBhc2tzIGZvciBjb2RlIG9yIHNheXMgXCJidWlsZFwiOlxyXG5Qb2xpdGVseSBleHBsYWluIHRoYXQgdGhlIGFwcCB3aWxsIGJlIGJ1aWx0IG9ubHkgd2hlbiB0aGV5IGNsaWNrIEJ1aWxkLlxyXG5UaGVuIGNvbnRpbnVlIHRoZSBpbnRlcnZpZXcuXHJcbjwvaW50ZXJ2aWV3X2JvdW5kYXJ5PlxyXG5cclxuUmV0dXJuIHBsYWluIHRleHQgb25seS5gO1xyXG5cclxuICAgIGNvbnN0IGNvbnZlcnNhdGlvblRleHQgPSBBcnJheS5pc0FycmF5KG1lc3NhZ2VzKVxyXG4gICAgICA/IG1lc3NhZ2VzXHJcbiAgICAgICAgICAuc2xpY2UoLTIwKVxyXG4gICAgICAgICAgLm1hcCgobTogYW55KSA9PiBgJHttLnJvbGU/LnRvVXBwZXJDYXNlPy4oKSB8fCAnVVNFUid9OiAke20uY29udGVudCB8fCAnJ31gKVxyXG4gICAgICAgICAgLmpvaW4oJ1xcbicpXHJcbiAgICAgIDogJyc7XHJcblxyXG4gICAgY29uc3QgZWRpdFN5c3RlbVByb21wdCA9IGA8ZWRpdF9yb2xlPlxyXG5JbiBlZGl0IG1vZGUsIHlvdSBoZWxwIHJlZmluZSBvciBpbXByb3ZlIGFuIGFscmVhZHktZ2VuZXJhdGVkIGFwcC5cclxuXHJcbllvdSBiZWhhdmUgbGlrZSBhIFVJL1VYLWZvY3VzZWQgcHJvZHVjdCBlbmdpbmVlci5cclxuPC9lZGl0X3JvbGU+XHJcblxyXG48ZWRpdF9ydWxlcz5cclxuMSkgQmUgZGlyZWN0IGFuZCBhY3Rpb25hYmxlXHJcbjIpIFByZWZlciBwcm9wb3NpbmcgYSBjb25jcmV0ZSBjaGFuZ2VcclxuMykgQXNrIGEgY2xhcmlmeWluZyBxdWVzdGlvbiBPTkxZIGlmIHJlcXVpcmVkXHJcbjQpIFVzZSBwcm92aWRlZCBVSSBjb250ZXh0IGZyb20gY2xpY2tlZCBlbGVtZW50c1xyXG41KSBBdm9pZCBodWdlIGV4cGxhbmF0aW9uc1xyXG48L2VkaXRfcnVsZXM+XHJcblxyXG48ZWRpdF9vdXRwdXQ+XHJcbllvdXIgcmVzcG9uc2Ugc2hvdWxkIGluY2x1ZGU6XHJcbi0gQSBzaG9ydCBwbGFuIE9SXHJcbi0gQSBzcGVjaWZpYyBVSS9VWCBzdWdnZXN0aW9uIE9SXHJcbi0gQSBmb2N1c2VkIGltcHJvdmVtZW50IHByb3Bvc2FsXHJcbjwvZWRpdF9vdXRwdXQ+XHJcblxyXG5SZXR1cm4gcGxhaW4gdGV4dCBvbmx5LmA7XHJcblxyXG4gICAgY29uc3QgY29udGV4dFRleHQgPSB1aUNvbnRleHRcclxuICAgICAgPyBgXFxuXFxuVUkgQ09OVEVYVCAoZnJvbSBjbGlja2VkIGVsZW1lbnQpOlxcbi0gc2VsZWN0b3I6ICR7dWlDb250ZXh0LnNlbGVjdG9yIHx8ICcnfVxcbi0gdGV4dDogJHt1aUNvbnRleHQudGV4dCB8fCAnJ31cXG4tIGh0bWxTbmlwcGV0OiAke3VpQ29udGV4dC5odG1sU25pcHBldCB8fCAnJ31cXG4tIHVybDogJHt1aUNvbnRleHQudXJsIHx8ICcnfVxcbmBcclxuICAgICAgOiAnJztcclxuXHJcbiAgICBjb25zdCBwcm9tcHQgPVxyXG4gICAgICBzYWZlTW9kZSA9PT0gJ2J1aWxkJ1xyXG4gICAgICAgID8gYFRoZSB1c2VyIGNsaWNrZWQgQnVpbGQuIFN1bW1hcml6ZSB0aGUgZmluYWwgcmVxdWlyZW1lbnRzIGluIDEwLTIwIGJ1bGxldCBwb2ludHMuXFxuXFxuQ29udmVyc2F0aW9uOlxcbiR7Y29udmVyc2F0aW9uVGV4dH1gXHJcbiAgICAgICAgOiBzYWZlTW9kZSA9PT0gJ2VkaXQnXHJcbiAgICAgICAgICA/IGAke2VkaXRTeXN0ZW1Qcm9tcHR9XFxuXFxuQ29udmVyc2F0aW9uIHNvIGZhcjpcXG4ke2NvbnZlcnNhdGlvblRleHR9JHtjb250ZXh0VGV4dH1cXG5cXG5Vc2VyIHJlcXVlc3Q6ICR7dXNlclRleHR9XFxuXFxuUmVzcG9uZCB3aXRoIHRoZSBiZXN0IG5leHQgc3RlcCAvIGNoYW5nZSBwcm9wb3NhbC5gXHJcbiAgICAgICAgICA6IGAke3N5c3RlbVByb21wdH1cXG5cXG5Db252ZXJzYXRpb24gc28gZmFyOlxcbiR7Y29udmVyc2F0aW9uVGV4dH1cXG5cXG5MYXN0IHVzZXIgbWVzc2FnZTogJHt1c2VyVGV4dH1cXG5cXG5Ob3cgcmVzcG9uZCB3aXRoIHlvdXIgbmV4dCBzaW5nbGUgcXVlc3Rpb24uYDtcclxuXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdlbmVyYXRlVGV4dChwcm9tcHQpO1xyXG4gICAgY29uc29sZS5sb2coJ0dlbmVyYXRlZCByZXNwb25zZTonLCByZXNwb25zZSk7XHJcbiAgICBcclxuICAgIGNvbnN0IHJlcGx5ID0ge1xyXG4gICAgICBpZDogU3RyaW5nKERhdGUubm93KCkgKyAxKSxcclxuICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXHJcbiAgICAgIGNvbnRlbnQ6IHJlc3BvbnNlLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnU2VuZGluZyByZXBseTonLCByZXBseSk7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVwbHkpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBjaGF0IEFQSTonLCBlcnJvcik7XHJcbiAgICBjb25zdCBtc2cgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvciA/PyAnVW5rbm93biBlcnJvcicpO1xyXG4gICAgY29uc3QgbSA9IG1zZy5tYXRjaCgvcmV0cnlEZWxheVwiXFxzKjpcXHMqXCIoXFxkKylzXCIvaSk7XHJcbiAgICBjb25zdCByZXRyeUFmdGVyU2Vjb25kcyA9IG0gPyBOdW1iZXIobVsxXSkgOiB1bmRlZmluZWQ7XHJcbiAgICBjb25zdCBpc1JhdGVMaW1pdGVkID0gbXNnLmluY2x1ZGVzKCdHZW1pbmkgQVBJIEVycm9yOiA0MjknKSB8fCBtc2cuaW5jbHVkZXMoJ1JFU09VUkNFX0VYSEFVU1RFRCcpO1xyXG4gICAgaWYgKGlzUmF0ZUxpbWl0ZWQpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdSQVRFX0xJTUlURUQnLCBkZXRhaWxzOiBtc2csIHJldHJ5QWZ0ZXJTZWNvbmRzOiByZXRyeUFmdGVyU2Vjb25kcyA/PyA2MCB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHN0YXR1czogNDI5LFxyXG4gICAgICAgICAgaGVhZGVyczogeyAnUmV0cnktQWZ0ZXInOiBTdHJpbmcocmV0cnlBZnRlclNlY29uZHMgPz8gNjApIH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBnZW5lcmF0ZSByZXNwb25zZScsIGRldGFpbHM6IG1zZyB9LFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZW5lcmF0ZVRleHQiLCJQT1NUIiwicmVxdWVzdCIsImNvbnNvbGUiLCJsb2ciLCJwcm9qZWN0SWQiLCJtZXNzYWdlcyIsIm1vZGUiLCJ1aUNvbnRleHQiLCJqc29uIiwic2FmZU1vZGUiLCJsYXN0VXNlck1lc3NhZ2UiLCJBcnJheSIsImlzQXJyYXkiLCJyZXZlcnNlIiwiZmluZCIsIm0iLCJyb2xlIiwidW5kZWZpbmVkIiwidXNlclRleHQiLCJjb250ZW50Iiwic3lzdGVtUHJvbXB0IiwiY29udmVyc2F0aW9uVGV4dCIsInNsaWNlIiwibWFwIiwidG9VcHBlckNhc2UiLCJqb2luIiwiZWRpdFN5c3RlbVByb21wdCIsImNvbnRleHRUZXh0Iiwic2VsZWN0b3IiLCJ0ZXh0IiwiaHRtbFNuaXBwZXQiLCJ1cmwiLCJwcm9tcHQiLCJyZXNwb25zZSIsInJlcGx5IiwiaWQiLCJTdHJpbmciLCJEYXRlIiwibm93IiwidGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJlcnJvciIsIm1zZyIsIkVycm9yIiwibWVzc2FnZSIsIm1hdGNoIiwicmV0cnlBZnRlclNlY29uZHMiLCJOdW1iZXIiLCJpc1JhdGVMaW1pdGVkIiwiaW5jbHVkZXMiLCJkZXRhaWxzIiwic3RhdHVzIiwiaGVhZGVycyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./app/services/gemini.ts":
/*!********************************!*\
  !*** ./app/services/gemini.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateText: () => (/* binding */ generateText)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n// app/services/gemini.ts\n\nconst GEMINI_API_URL = \"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent\";\nasync function generateText(prompt) {\n    try {\n        console.log(\"Calling Gemini API with prompt:\", prompt);\n        const apiKey = process.env.GEMINI_API_KEY;\n        if (!apiKey) {\n            throw new Error(\"Missing GEMINI_API_KEY. Set it in your environment (.env.local) and restart the dev server.\");\n        }\n        const redactedKey = apiKey.length <= 8 ? \"***\" : `${apiKey.slice(0, 4)}...${apiKey.slice(-4)}`;\n        console.log(\"Gemini API key loaded (redacted):\", redactedKey);\n        const response = await fetch(`${GEMINI_API_URL}?key=${apiKey}`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n                contents: [\n                    {\n                        parts: [\n                            {\n                                text: prompt\n                            }\n                        ]\n                    }\n                ]\n            })\n        });\n        console.log(\"Gemini API response status:\", response.status);\n        if (!response.ok) {\n            const errorText = await response.text();\n            console.error(\"Gemini API error response:\", errorText);\n            throw new Error(`Gemini API Error: ${response.status} - ${errorText}`);\n        }\n        const data = await response.json();\n        console.log(\"Gemini API response data:\", data);\n        const text = data.candidates?.[0]?.content?.parts?.[0]?.text;\n        if (!text) {\n            console.error(\"No text in Gemini response:\", data);\n            throw new Error(\"No valid response from Gemini\");\n        }\n        return text;\n    } catch (error) {\n        console.error(\"Error generating text with Gemini:\", error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvc2VydmljZXMvZ2VtaW5pLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLHlCQUF5QjtBQUNKO0FBRXJCLE1BQU1BLGlCQUFpQjtBQUVoQixlQUFlQyxhQUFhQyxNQUFjO0lBQy9DLElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDLG1DQUFtQ0Y7UUFFL0MsTUFBTUcsU0FBU0MsUUFBUUMsR0FBRyxDQUFDQyxjQUFjO1FBQ3pDLElBQUksQ0FBQ0gsUUFBUTtZQUNYLE1BQU0sSUFBSUksTUFBTTtRQUNsQjtRQUVBLE1BQU1DLGNBQWNMLE9BQU9NLE1BQU0sSUFBSSxJQUFJLFFBQVEsQ0FBQyxFQUFFTixPQUFPTyxLQUFLLENBQUMsR0FBRyxHQUFHLEdBQUcsRUFBRVAsT0FBT08sS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDO1FBQzlGVCxRQUFRQyxHQUFHLENBQUMscUNBQXFDTTtRQUVqRCxNQUFNRyxXQUFXLE1BQU1DLE1BQU0sQ0FBQyxFQUFFZCxlQUFlLEtBQUssRUFBRUssT0FBTyxDQUFDLEVBQUU7WUFDOURVLFFBQVE7WUFDUkMsU0FBUztnQkFDUCxnQkFBZ0I7WUFDbEI7WUFDQUMsTUFBTUMsS0FBS0MsU0FBUyxDQUFDO2dCQUNuQkMsVUFBVTtvQkFBQzt3QkFDVEMsT0FBTzs0QkFBQztnQ0FDTkMsTUFBTXBCOzRCQUNSO3lCQUFFO29CQUNKO2lCQUFFO1lBQ0o7UUFDRjtRQUVBQyxRQUFRQyxHQUFHLENBQUMsK0JBQStCUyxTQUFTVSxNQUFNO1FBRTFELElBQUksQ0FBQ1YsU0FBU1csRUFBRSxFQUFFO1lBQ2hCLE1BQU1DLFlBQVksTUFBTVosU0FBU1MsSUFBSTtZQUNyQ25CLFFBQVF1QixLQUFLLENBQUMsOEJBQThCRDtZQUM1QyxNQUFNLElBQUloQixNQUFNLENBQUMsa0JBQWtCLEVBQUVJLFNBQVNVLE1BQU0sQ0FBQyxHQUFHLEVBQUVFLFVBQVUsQ0FBQztRQUN2RTtRQUVBLE1BQU1FLE9BQU8sTUFBTWQsU0FBU2UsSUFBSTtRQUNoQ3pCLFFBQVFDLEdBQUcsQ0FBQyw2QkFBNkJ1QjtRQUV6QyxNQUFNTCxPQUFPSyxLQUFLRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLEVBQUVDLFNBQVNULE9BQU8sQ0FBQyxFQUFFLEVBQUVDO1FBQ3hELElBQUksQ0FBQ0EsTUFBTTtZQUNUbkIsUUFBUXVCLEtBQUssQ0FBQywrQkFBK0JDO1lBQzdDLE1BQU0sSUFBSWxCLE1BQU07UUFDbEI7UUFFQSxPQUFPYTtJQUNULEVBQUUsT0FBT0ksT0FBTztRQUNkdkIsUUFBUXVCLEtBQUssQ0FBQyxzQ0FBc0NBO1FBQ3BELE1BQU1BO0lBQ1I7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWFwcC1idWlsZGVyLXdlYi8uL2FwcC9zZXJ2aWNlcy9nZW1pbmkudHM/MjkyMCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBhcHAvc2VydmljZXMvZ2VtaW5pLnRzXHJcbmltcG9ydCAnc2VydmVyLW9ubHknO1xyXG5cclxuY29uc3QgR0VNSU5JX0FQSV9VUkwgPSAnaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy9nZW1pbmktMi41LWZsYXNoOmdlbmVyYXRlQ29udGVudCc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVUZXh0KHByb21wdDogc3RyaW5nKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCdDYWxsaW5nIEdlbWluaSBBUEkgd2l0aCBwcm9tcHQ6JywgcHJvbXB0KTtcclxuICAgIFxyXG4gICAgY29uc3QgYXBpS2V5ID0gcHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVk7XHJcbiAgICBpZiAoIWFwaUtleSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgR0VNSU5JX0FQSV9LRVkuIFNldCBpdCBpbiB5b3VyIGVudmlyb25tZW50ICguZW52LmxvY2FsKSBhbmQgcmVzdGFydCB0aGUgZGV2IHNlcnZlci4nKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZWRhY3RlZEtleSA9IGFwaUtleS5sZW5ndGggPD0gOCA/ICcqKionIDogYCR7YXBpS2V5LnNsaWNlKDAsIDQpfS4uLiR7YXBpS2V5LnNsaWNlKC00KX1gO1xyXG4gICAgY29uc29sZS5sb2coJ0dlbWluaSBBUEkga2V5IGxvYWRlZCAocmVkYWN0ZWQpOicsIHJlZGFjdGVkS2V5KTtcclxuICAgIFxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtHRU1JTklfQVBJX1VSTH0/a2V5PSR7YXBpS2V5fWAsIHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgY29udGVudHM6IFt7XHJcbiAgICAgICAgICBwYXJ0czogW3tcclxuICAgICAgICAgICAgdGV4dDogcHJvbXB0XHJcbiAgICAgICAgICB9XVxyXG4gICAgICAgIH1dXHJcbiAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnR2VtaW5pIEFQSSByZXNwb25zZSBzdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcclxuXHJcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcclxuICAgICAgY29uc29sZS5lcnJvcignR2VtaW5pIEFQSSBlcnJvciByZXNwb25zZTonLCBlcnJvclRleHQpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEdlbWluaSBBUEkgRXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAtICR7ZXJyb3JUZXh0fWApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICBjb25zb2xlLmxvZygnR2VtaW5pIEFQSSByZXNwb25zZSBkYXRhOicsIGRhdGEpO1xyXG4gICAgXHJcbiAgICBjb25zdCB0ZXh0ID0gZGF0YS5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzPy5bMF0/LnRleHQ7XHJcbiAgICBpZiAoIXRleHQpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignTm8gdGV4dCBpbiBHZW1pbmkgcmVzcG9uc2U6JywgZGF0YSk7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdmFsaWQgcmVzcG9uc2UgZnJvbSBHZW1pbmknKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHRleHQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgdGV4dCB3aXRoIEdlbWluaTonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiR0VNSU5JX0FQSV9VUkwiLCJnZW5lcmF0ZVRleHQiLCJwcm9tcHQiLCJjb25zb2xlIiwibG9nIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIkdFTUlOSV9BUElfS0VZIiwiRXJyb3IiLCJyZWRhY3RlZEtleSIsImxlbmd0aCIsInNsaWNlIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImNvbnRlbnRzIiwicGFydHMiLCJ0ZXh0Iiwic3RhdHVzIiwib2siLCJlcnJvclRleHQiLCJlcnJvciIsImRhdGEiLCJqc29uIiwiY2FuZGlkYXRlcyIsImNvbnRlbnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/services/gemini.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=E%3A%5CAI%20App%20Builder%5CFGH%5CBrix-maybe%5Cweb%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5CAI%20App%20Builder%5CFGH%5CBrix-maybe%5Cweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();